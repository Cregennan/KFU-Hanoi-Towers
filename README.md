# Ханойские башни
**Второй проект из трёх по программированию на 2 семестре**
**Единственный проект из трёх с полными комментариями к коду**
![](https://sun9-21.userapi.com/impg/4Y8cD0s4aqbBelXoinnj3zngL6cc252Jb2AYhQ/XVVGYO374wo.jpg?size=800x478&quality=96&sign=be4f584be457ae72125cc12dfe3ad66a&type=album)

## Структура
|Класс (Окно) | Описание|
| ------------ | ------------ |
|AutomaticGame|Окно автоматической игры|
|ManualGame|Окно ручной игры|
|MainWindow|Начальное окно|
|GameSettings|Класс с константами, определениями и цветами|

## Как всё работает

Поле для игры содержит кроме элементов управления и дизайна три ``Canvas``. Они выступают в роли направляющих для колец. 

![](https://sun9-81.userapi.com/impg/R6V3NpK96wnNAb0vgOTLhyB6VZfkykaEqfu4NA/RFyQeWpNO8o.jpg?size=735x437&quality=96&sign=2449dc72c8599705834a5514ccdc9e4a&type=album)

Правила игры похожи на стек тем, что извлекать кольцо мы можем только сверху столбика (с конца стека). Поэтому, мы можем представить содержимое направляющих ``Canvas`` как стеки. Каждый ``Canvas`` содержит в себе массив потомков, поэтому работать с ними будем как с элементами стека и делать проверки (извлекать, добавлять) только с конца (в конец) массива. Отдельные три канваса были добавлены для того, чтобы в их содержимых не было ничего, кроме колец (прямоугольников). 

### Автоматический режим
При генерации колец и начале игры, по простому алгоритму (гуглится) просчитывается перемещение каждого кольца. Далее, асинхронно рисуется анимация перемещения. 
### Ручной режим
При удержании ЛКМ на кольце, вызывается событие. Оно определяет, можно ли снять данное кольцо с колышка. Если да, вызывается событие перетаскивания. 
При наведении всё еще зажатой ЛКМ на столбец, последний проводит проверку на то, допустимо ли помещение этого кольца на него. К примеру, не пытается ли игрок поместить кольцо на кольцо меньшего размера. Если всё ок, то вызывается анимация перемещения кольца. 
### Анимация перемещения кольца
Каждое кольцо находится в своём колышке и не получится отрисовывать кольцо за пределами ``Canvas`` колышка.  Поэтому, при запуске анимации перемещения, считаются несколько параметров, такие как:
- Исходные координаты колечка в колышке
- Конечные координаты колечка в другом колышке
- Исходные координаты колечка в окне
- Конечные координаты колечка в окне

После этого, прямоугольник (колечко) в колышке становится прозрачным и прямо над ним отрисовывается новый прямоугольник на том же положении и того-же размера. После чего, к нему применяется асинхронная анимация перемещения (меняются X и Y). Когда прямоугольник достигает своего места в окне, он удаляется, и колечко из предыдущего колышка телепортируется на следующее.
